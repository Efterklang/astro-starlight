---
title: æ•°å­—ç”µè·¯è®¾è®¡ä¸åµŒå…¥å¼å¼€å‘â€”â€”ç»„åˆé€»è¾‘ç”µè·¯çš„Verilogå®ç°
date: 2024-11-1
excerpt: 22çº§ç”µå­ç§‘æŠ€å¤§å­¦è½¯ä»¶å·¥ç¨‹å­¦é™¢(åµŒå…¥å¼æ–¹å‘)ï¼Œæ•°å­—ç”µè·¯è®¾è®¡ä¸åµŒå…¥å¼å¼€å‘å®éªŒæŠ¥å‘Š(Lab2);
categories: [Miscellaneous]
tags: [FPGA, UESTC, Verilog]
---

## Intro

22 çº§ç”µå­ç§‘æŠ€å¤§å­¦è½¯ä»¶å·¥ç¨‹å­¦é™¢(åµŒå…¥å¼æ–¹å‘)ï¼Œæ•°å­—ç”µè·¯è®¾è®¡ä¸åµŒå…¥å¼å¼€å‘å®éªŒæŠ¥å‘Š;
å…¶ä¸­åŒ…å«

- `lab2-1`: ä½¿ç”¨å¼€å…³ `SW0~SW6` å®Œæˆå¯¹ 6 ä¸ª 7 æ®µæ˜¾ç¤ºçš„æ§åˆ¶ã€‚
  - `SW3~SW0` æ§åˆ¶æ˜¾ç¤ºçš„æ•°æ®ï¼Œä» 0 åˆ° Fï¼›
  - `SW6~SW4` æ§åˆ¶ç”¨å…­ä¸ª 7 æ®µæ•°ç ç®¡ï¼Œ000 å¯¹åº” 7SD-1, 001 å¯¹åº” 7SD-2ï¼Œä»¥æ­¤ç±»æ¨ï¼Œ101 å¯¹åº” 7SD-6ï¼Œå…¶å®ƒæƒ…å†µä¸‹éƒ½ä¸æ˜¾ç¤ºã€‚
- `lab2-2`: ç”¨ Verilog å®ç°ä¸€ä¸ª 2 ä½ 3 é€‰ 1 æ•°æ®é€‰æ‹©å™¨ã€‚
- `lab2-3`: ç”¨ Verilog å®ç°ä¸€ä¸ª 3 çº¿-8 çº¿è¯‘ç å™¨
- `lab2-4`: ç”¨ Verilog å®ç°ä¸€ä¸ª 8 çº¿-3 çº¿ç¼–ç å™¨
- `lab2-5`: ç”¨ Verilog å®ç°ä¸€ä¸ª 3 ä½äºŒè¿›åˆ¶åŠ å‡æ³•å™¨ã€‚X=0 æ—¶è¿›è¡ŒåŠ æ³•è®¡ç®—ï¼›X=1 æ—¶è¿›è¡Œå‡æ³•è®¡ç®—

æœ¬äººå¤§äºŒä¸Šé€‰æ‹©æ–¹å‘æ—¶ï¼Œå¯¹å‡ ä¸ªæ–¹å‘éƒ½ä¸ç”šäº†è§£ï¼›åé¢å­¦åˆ°åµŒå…¥å¼ä¸“ä¸šè¯¾æ‰å‘è§‰è‡ªå·±å¯¹æ­¤ä¸æ„Ÿå…´è¶£ï¼Œå‡ é—¨ä¸“ä¸šè¯¾ä¹Ÿéƒ½æ²¡æœ‰å¬(ä¸€èŠ‚è¯¾ä¹Ÿæ²¡æœ‰)ï¼ŒåµŒå…¥å¼ç›¸å…³çŸ¥è¯†çš„å­¦ä¹ ~~å‹åŠ›~~åŠ¨åŠ›å…¨æ¥è‡ªäºå¹³æ—¶ä½œä¸š&è¯¾ç¨‹ labï¼Œæ•…å¯¹æŠ¥å‘Šè´¨é‡ä¸ä½œä¿è¯ï¼›

---

22 çº§åµŒå…¥å¼ç›¸å…³è¯¾ç¨‹ï¼Œé€‰æ‹©æ–¹å‘æ—¶å¯ä»¥ä½œä¸ºå‚è€ƒï¼Œçœ‹ä¸‹è‡ªå·±å¯¹ç›¸å…³è¯¾ç¨‹æ˜¯å¦æ„Ÿå…´è¶£ ğŸ˜Š

- å¤§äºŒä¸Šï¼šæ²¡æœ‰ä¸“ä¸šè¯¾ï¼›
  åµŒå…¥å¼å­¦ç”Ÿæœ€çˆ½æ—¶åˆ» top1ï¼Œæ€€å¿µä¸€å‘¨ä¸‰ä¼‘
- å¤§äºŒä¸‹ï¼šåµŒå…¥å¼ç³»ç»Ÿï¼ŒARM å¤„ç†å™¨ä½“ç³»ç»“æ„åŠåº”ç”¨ï¼›
  äºŒé—¨åµŒå…¥å¼ä¸“ä¸šè¯¾ï¼Œå¼€å·è€ƒã€‚~~é‚£åœºè€ƒè¯•æ¯äº†æˆ‘çš„ä¿ç ”æ¢¦,é€‰æ‹©åµŒå…¥å¼æˆ‘æ²¡æœ‰åæ‚”ã€‚#æ²‰æ·€#é¡¶å³°ç›¸è§#ä¿ç ”æ¢¦#é»‘çš®ç¨‹åºå‘˜~~ ğŸ˜­<img src="https://vluv-space.s3.bitiful.net/UESTC/Embedded/lab2/lab2-4.webp" alt="" style="width: 20%"/>
- å¤§ä¸‰ä¸Šï¼šæ•°å­—ç”µè·¯è®¾è®¡ä¸åµŒå…¥å¼å¼€å‘(+FPGA)ï¼›
  å®éªŒçš„è¯¾æ—¶å®‰æ’çš„å‘¨å…­ï¼Œå…± 6 å‘¨ã€‚æ•°ç”µå’Œå½¢ç­–æ‰“äº†ä¸€æ³¢é…åˆï¼Œäº”å‘¨å†…ä½“éªŒå››æ¬¡å•ä¼‘ ğŸ‘ğŸ‘ğŸ‘ï¼›åµŒå…¥å¼å­¦ç”Ÿæœ€çˆ½æ—¶åˆ» top-1
  10.5 å‘¨å…­ï¼Œå½¢ç­–ï¼›10.12 å‘¨å…­ï¼Œå›½åº†è°ƒä¼‘ä¸Šæ•°ç”µï¼›10.19 å–˜æ¯ä¸€å‘¨ï¼›10.26FPGA å®éªŒï¼Œ11.1 æ•°ç”µå®éªŒï¼›åé¢å‘¨ä¸€å°±æ²¡è¯¾äº†ï¼Œå‹‰å¼ºè‹Ÿå»¶æ®‹å–˜

**NOTE**

å®éªŒè¯¾çš„æ˜¾ç¤ºå™¨åº”è¯¥æ˜¯[Lenovo D186](https://support.lenovo.com/us/en/solutions/pd013690-lenovo-d186-185-in-wide-lcd-monitor-overview)ï¼Œç”µè„‘ç³»ç»Ÿ windows xpã€‚ç›®æµ‹è®¾å¤‡å¹´é¾„è¶…è¿‡ 10 å¹´ï¼Œä½¿ç”¨è¿‡ç¨‹ä¸­æ˜¯æ¯”è¾ƒå¡é¡¿çš„ï¼›IDE çš„ç¼–è¾‘ä½“éªŒå’Œç¬”è®°æœ¬æ¯”è¾ƒç±»ä¼¼ã€‚
æ­¤å¤–æ‹·è´ç¨‹åºå»ºè®®åˆ«ç”¨å¤ªæ–°çš„ u ç›˜ï¼Œå¯èƒ½è·Ÿæ–‡ä»¶ç³»ç»Ÿæœ‰å…³ï¼Ÿæ²¡ç ”ç©¶è¿‡è¿™äº›ã€‚ä¸‹å›¾ä¸­çš„ U ç›˜å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œä½†æ˜¨å¤©è¢«æˆ‘æåäº†...

| <img src="https://vluv-space.s3.bitiful.net/UESTC/Embedded/lab2/lab2-6.webp" alt="" style="width: 90%"/> | <img src="https://vluv-space.s3.bitiful.net/UESTC/Embedded/lab2/lab2-7.webp" alt="" style="width: 50%"/> |
| -------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------- |

## Part 1

### å®éªŒç»“æœä¸åˆ†æ

ä½¿ç”¨å¼€å…³ `SW0~SW6` å®Œæˆå¯¹ 6 ä¸ª 7 æ®µæ˜¾ç¤ºçš„æ§åˆ¶ã€‚
å®šä¹‰æ¨¡å— `seven_seg_display`ï¼Œæ¥æ”¶ä¸¤ä¸ªè¾“å…¥ `hexnum` å’Œ `select`ï¼Œè¾“å‡ºä¸¤ä¸ªè¾“å‡º `led` å’Œ `show`

é¦–å…ˆé€šè¿‡`case`è¯­å¥åˆ¤æ–­`select`çš„å€¼ï¼Œç„¶åé€šè¿‡ assign è¯­å¥æ›´æ–°`led`çš„å€¼ï¼›è¿™ä¸ª case è¯­å¥çš„ä½œç”¨æ˜¯ï¼Œè´Ÿè´£æ§åˆ¶é€‰æ‹©ç”¨å“ªä¸€ä¸ª 7 æ®µæ•°ç ç®¡æ¥æ˜¾ç¤ºæ•°å­—

æ¯”å¦‚å¸Œæœ›åœ¨`select==0`æ—¶ç‚¹äº®`DISP1 LTD-4708JR`æ•°ç ç®¡ï¼Œå¯ä»¥åœ¨ä¸‹é¢çš„çº¦æŸæ–‡ä»¶ä¸­æ·»åŠ `NET led<0> LOC=M17;`è¯­å¥å°†`led[0]`ä¸`M17`å¼•è„šç»‘å®šï¼Œå³`led[0]`å¯¹åº”ç”µè·¯å›¾ä¸­çš„`7SD-C1`ä¿¡å·ã€‚å½“é‡åˆ°`3'b000`è¿™ä¸ª case æ—¶ï¼Œ`led=6'b000001;`,å³`led[0]`èµ‹å€¼ä¸º 1ï¼Œå³`7SD-C1`ä¸ºé«˜ç”µå¹³,å³é€‰ä¸­ç¬¬ä¸€ä¸ªæ•°ç ç®¡ C1 è¿›è¡Œæ˜¾ç¤º;

<img src="https://vluv-space.s3.bitiful.net/UESTC/Embedded/lab2/lab2-1.webp" alt="" style="width: 50%"/>

<br/>

ç„¶åé€šè¿‡`display`çš„ 8 ä¸ª bits åˆ†åˆ«è´Ÿè´£`a,b,c,d,e,f,g,dp`æ•°ç ç®¡çš„äº®ç­ï¼Œä»è€Œæ›´æ–°æ˜¾ç¤ºçš„ hexadecimal number;æœ¬å®éªŒä¸­ Digilent Anvyl å¼€å‘æ¿ä¸Šçš„æ•°ç ç®¡ä¸ºå…±é˜´ææ•°ç ç®¡ã€‚ä»¥`4'h0: display = 8'b11111100;`ä¸ºä¾‹ï¼Œè¡¨ç¤º`a,b,c,d,e,f`äº®ï¼Œ`g,dp`ç­ï¼›

|      bin      |  hex  |
| :-----------: | :---: |
| `8'b11111100` |  `0`  |
| `8'b01100000` |  `1`  |
| `8'b11011010` |  `2`  |
| `8'b11110010` |  `3`  |
| `8'b01100110` |  `4`  |
| `8'b10110110` |  `5`  |
| `8'b10111110` |  `6`  |
| `8'b11100000` |  `7`  |
| `8'b11111110` |  `8`  |
| `8'b11100110` |  `9`  |
| `8'b11101110` |  `a`  |
| `8'b00111110` |  `b`  |
| `8'b10011100` |  `c`  |
| `8'b01111010` |  `d`  |
| `8'b10011110` |  `e`  |
| `8'b10001110` |  `f`  |

<img src="https://vluv-space.s3.bitiful.net/UESTC/Embedded/lab2/lab2.webp" alt="" style="width: 50%"/>

```verilog
module seven_seg_display (
    input [3:0] hexnum,          // 4-bit input, controls displayed data (0 to F)
    input [2:0] select,          // 3-bit input, selects which 7-segment display to control (000 to 101)
    output reg [5:0] led,        // 6-bit output, activates one of six 7-segment displays
    output reg [7:0] display        // 8-bit output, controls the segments of the 7-segment display
);

    // Control which 7-segment display is active based on the 'select' input
    always @(*) begin
        case (select)
            3'b000: led = 6'b000001; // Activate 7SD-1
            3'b001: led = 6'b000010; // Activate 7SD-2
            3'b010: led = 6'b000100; // Activate 7SD-3
            3'b011: led = 6'b001000; // Activate 7SD-4
            3'b100: led = 6'b010000; // Activate 7SD-5
            3'b101: led = 6'b100000; // Activate 7SD-6
            default: led = 6'b000000; // Turn off all displays for other values of 'select'
        endcase
    end

    // Determine the pattern to display on the 7-segment display based on 'hexnum'
    always @(*) begin
        case (hexnum)
            4'h0: display = 8'b11111100; // Display 0
            4'h1: display = 8'b01100000; // Display 1
            4'h2: display = 8'b11011010; // Display 2
            4'h3: display = 8'b11110010; // Display 3
            4'h4: display = 8'b01100110; // Display 4
            4'h5: display = 8'b10110110; // Display 5
            4'h6: display = 8'b10111110; // Display 6
            4'h7: display = 8'b11100000; // Display 7
            4'h8: display = 8'b11111110; // Display 8
            4'h9: display = 8'b11100110; // Display 9
            4'hA: display = 8'b11101110; // Display A
            4'hB: display = 8'b00111110; // Display B
            4'hC: display = 8'b10011100; // Display C
            4'hD: display = 8'b01111010; // Display D
            4'hE: display = 8'b10011110; // Display E
            4'hF: display = 8'b10001110; // Display F
            default: display = 8'b00000000; // Turn off all segments for invalid hexnum
        endcase
    end
endmodule
```

å‚ç…§è¯¥å›¾ï¼Œè¡¥å…¨çº¦æŸæ–‡ä»¶ï¼Œä½¿å¾—æ•°å­— 0~F åœ¨ æ­£ç¡®çš„ 7 æ®µæ•°ç ç®¡ä¸Šä»¥æ­£ç¡®çš„å½¢å¼æ˜¾ç¤ºã€‚

<img src="https://vluv-space.s3.bitiful.net/UESTC/Embedded/lab2/lab2-2.webp" alt="" style="width: 50%"/>

```shell
# ä¸‹é¢æ˜¯ucfæ–‡ä»¶ï¼Œä¸ºäº†æ˜¾ç¤ºæ•ˆæœï¼Œæ–‡ä¸­ç”¨bashä»£ç å—è¿›è¡Œé«˜äº®
NET hexnum<O> LOC=V5;
NET hexnum<1> LOC=U4;
NET hexnum<2> LOC=V3;
NET hexnum<3> LOC=P4;
NET select<O> LOC=R4;
NET select<1> LOC=P6;
NET select<2> LOC=P5
NET led<0> LOC=M17;
NET led<1> LOC=P16;
NET led<2> LOC=P19;
NET led<3> LOC=N16;
NET led<4> LOC=AB21;
NET led<5> LOC=AA20;
NET display<O> LOC=P15;
NET display<1> LOC=Y21
NET display<2> LOC=P20;
NET display<3> LOC=AB19;
NET display<4> LOC=N15;
NET display<5> LOC=Y22;
NET display<6> LOC=AA22;
NET display<7> LOC=AA21;
```

### éªŒè¯å›¾ç‰‡

ç¼–è¯‘åå°† bit æ–‡ä»¶å†™å…¥å¼€å‘æ¿éªŒè¯å³å¯

![alt text](https://vluv-space.s3.bitiful.net/UESTC/Embedded/lab2/lab2-3.webp)

## Part 2

### å®éªŒç»“æœä¸åˆ†æ

æ ¹æ®æ§åˆ¶ä¿¡å· C çš„å€¼ï¼Œé€‰æ‹©ä¸€ä¸ª 2 ä½è¾“å…¥ä¿¡å· D0ã€D1 æˆ– D2ï¼Œå¹¶å°†è¯¥ä¿¡å·è¾“å‡ºåˆ° Yã€‚ä¸‹é¢æ˜¯ä»£ç çš„å…·ä½“è§£é‡Šå’Œå®ç°æ€è·¯ã€‚è¾“å‡ºä¿¡å·é€šè¿‡ LD0 å’Œ LD1 ä¸¤ä¸ªå‘å…‰äºŒæç®¡è¿›è¡ŒéªŒè¯

```verilog
module Mux3to1_2bit (
    input [1:0] C,
    input [1:0] D0,
    input [1:0] D1,
    input [1:0] D2,
    output reg[1:0] Y
);
    always@(*)
    case (C)
        2'b00: Y = D0;
        2'b01: Y = D1;
        2'b10: Y = D2;
        default: Y = 2'b00;
    endcase
endmodule
```

### éªŒè¯å›¾ç‰‡

![alt text](https://vluv-space.s3.bitiful.net/UESTC/Embedded/lab2/lab2-5.webp)

## Part 3

### å®éªŒç»“æœä¸åˆ†æ

è¾“å…¥ç«¯æœ‰ 3 æ ¹ä¿¡å·çº¿,è¡¨ç¤ºä»`000`åˆ°`111` 8 ç§ä¸åŒçš„äºŒè¿›åˆ¶ç»„åˆï¼Œè¾“å‡ºç«¯æœ‰ 8 æ ¹ä¿¡å·çº¿,æ¯ä¸€æ ¹çº¿å¯¹åº”è¾“å…¥çš„ä¸€ç§äºŒè¿›åˆ¶ç»„åˆã€‚
ç¼–å†™å¦‚ä¸‹ä»£ç ï¼Œç„¶ååœ¨çº¦æŸæ–‡ä»¶ä¸­å°†`out[0]-outp[7]`åˆ†åˆ«ç»‘å®šåˆ° LD0 åˆ° LD7 å…«ä¸ª LED ç¯å³å¯

```verilog
module decoder3to8(
 input [2:0] in, // 3-bit input
 output reg [7:0] out // 8-bit output
);
    always @(*) begin
        out = 8'b0000_0000; // åˆå§‹åŒ–è¾“å‡º
        case (in)
            3'b000: out  = 8'b0000_0001;
            3'b001: out  = 8'b0000_0010;
            3'b010: out  = 8'b0000_0100;
            3'b011: out  = 8'b0000_1000;
            3'b100: out  = 8'b0001_0000;
            3'b101: out  = 8'b0010_0000;
            3'b110: out  = 8'b0100_0000;
            3'b111: out  = 8'b1000_0000;
            default: out = 8'b0000_0000;
        endcase
    end
endmodule
```

### éªŒè¯å›¾ç‰‡

é˜Ÿå‹çš„ç‰æ‰‹å‡ºé•œï¼Œæ‹¨ç æŒ¡ä½äº†ï¼Œæ‡’å¾—é‡æ–°æ‹äº†(æ²¡æŒ¡ä½çœ‹å¾—ä¹Ÿè´¹åŠ›ï¼Œè€å¸ˆåº”è¯¥ä¹Ÿä¸ä¼šç»†çœ‹)

![alt text](https://vluv-space.s3.bitiful.net/UESTC/Embedded/lab2/lab2-9.webp)

## Part 4

### å®éªŒç»“æœä¸åˆ†æ

ä»£ç ç»“æ„ä¸ 3-8 è¯‘ç å™¨ç±»ä¼¼ï¼Œå°†è¾“å…¥è¾“å‡ºå€’ç½®å³å¯ã€‚åœ¨çº¦æŸæ–‡ä»¶ä¸­ï¼Œ`out[0]ã€out[1]ã€out[2]`ç»‘å®šåˆ°`LD0ã€LD1ã€LD2`å³å¯

```verilog
module encoder8to3(
 input [7:0] in, // 8-bit input
 output reg [2:0] out // 3-bit output
);
    always @(*) begin
        case (in)
            8'b0000_0001: out = 3'b000;
            8'b0000_0010: out = 3'b001;
            8'b0000_0100: out = 3'b010;
            8'b0000_1000: out = 3'b011;
            8'b0001_0000: out = 3'b100;
            8'b0010_0000: out = 3'b101;
            8'b0100_0000: out = 3'b110;
            8'b1000_0000: out = 3'b111;
            default: out      = 3'b000;
        endcase
    end
endmodule
```

### éªŒè¯å›¾ç‰‡

![alt text](https://vluv-space.s3.bitiful.net/UESTC/Embedded/lab2/lab2-10.webp)

## Part 5

### å®éªŒç»“æœä¸åˆ†æ

> ç”¨ Verilog å®ç°ä¸€ä¸ª 3 ä½äºŒè¿›åˆ¶åŠ å‡æ³•å™¨ã€‚X=0 æ—¶è¿›è¡ŒåŠ æ³•è®¡ç®—ï¼›X=1 æ—¶è¿›è¡Œå‡æ³•è®¡ç®—

ä»£ç æ ¹æ®æ§åˆ¶ä¿¡å· X çš„å€¼æ¥å†³å®šæ˜¯æ‰§è¡ŒåŠ æ³•è¿˜æ˜¯å‡æ³•æ“ä½œ

- `A` å’Œ `B` æ˜¯ 3 ä½çš„**æ— ç¬¦å·**æ“ä½œæ•°(å³å…¨ä¸ºæ­£æ•°)
- `X` æ˜¯æ§åˆ¶ä¿¡å·ï¼Œå½“ `X = 0` æ—¶æ‰§è¡ŒåŠ æ³•ï¼Œå½“ `X = 1` æ—¶æ‰§è¡Œå‡æ³•ã€‚
- `Y` æ˜¯ 4 ä½è¾“å‡ºç»“æœï¼Œè¿”å›è¿ç®—ç»“æœçš„è¡¥ç å½¢å¼
- `Overflow` ä½œä¸º Flagï¼Œç”¨äºæŒ‡ç¤ºæ˜¯å¦åœ¨æ“ä½œä¸­å‘ç”Ÿæº¢å‡ºã€‚

{% message color:primary "title: è¡¥ç  wikipedia"%}

è¡¥ç ï¼ˆè‹±è¯­ï¼š2's complementï¼‰æ˜¯ä¸€ç§ç”¨äºŒè¿›åˆ¶è¡¨ç¤ºæœ‰ç¬¦å·æ•°çš„æ–¹æ³•ï¼Œä¹Ÿæ˜¯ä¸€ç§å°†æ•°å­—çš„æ­£è´Ÿå·å˜å·çš„æ–¹å¼ï¼Œå¸¸åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ä½¿ç”¨ã€‚è¡¥ç ä»¥æœ‰ç¬¦å·æ¯”ç‰¹çš„äºŒè¿›åˆ¶æ•°å®šä¹‰ã€‚

æ­£æ•°å’Œ 0 çš„è¡¥ç å°±æ˜¯è¯¥æ•°å­—æœ¬èº«å†è¡¥ä¸Šæœ€é«˜æ¯”ç‰¹ 0ã€‚è´Ÿæ•°çš„è¡¥ç åˆ™æ˜¯å°†å…¶ç»å¯¹å€¼æŒ‰ä½å–åå†åŠ  1ã€‚

è¡¥ç ç³»ç»Ÿçš„æœ€å¤§ä¼˜ç‚¹æ˜¯å¯ä»¥åœ¨åŠ æ³•æˆ–å‡æ³•å¤„ç†ä¸­ï¼Œä¸éœ€å› ä¸ºæ•°å­—çš„æ­£è´Ÿè€Œä½¿ç”¨ä¸åŒçš„è®¡ç®—æ–¹å¼ã€‚åªè¦ä¸€ç§åŠ æ³•ç”µè·¯å°±å¯ä»¥å¤„ç†å„ç§æœ‰å·æ•°åŠ æ³•ï¼Œè€Œä¸”å‡æ³•å¯ä»¥ç”¨ä¸€ä¸ªæ•°åŠ ä¸Šå¦ä¸€ä¸ªæ•°çš„è¡¥ç æ¥è¡¨ç¤ºï¼Œå› æ­¤åªè¦æœ‰åŠ æ³•ç”µè·¯åŠè¡¥ç ç”µè·¯å³å¯å®Œæˆå„ç§æœ‰å·æ•°åŠ æ³•åŠå‡æ³•ï¼Œåœ¨ç”µè·¯è®¾è®¡ä¸Šç›¸å½“æ–¹ä¾¿ã€‚

æˆ‘åœ¨ä¸‹é¢ä¸¾ä¸ªæ —å­ ğŸ‘‡

| decimal  | binary | complement       |
| -------- | ------ | ---------------- |
| `2`      | `0010` | `0010`           |
| `-3`     | `1011` | `1101`           |
| `2-3=-1` | `1111` | `0010+1101=1111` |
| `2+3=5`  | `0101` | `0010+0011=0101` |

{% endmessage %}

ä¸ºæ–¹ä¾¿è¿ç®—ï¼Œåœ¨è®¡ç®—è¿‡ç¨‹ä¸­éœ€è¦å°†è¿ç®—æ•°è½¬ä¸ºè¡¥ç ;è½¬æ¢çš„è¿‡ç¨‹å¦‚ä¸‹

- `A` ä½œä¸ºè¢«åŠ æ•°/è¢«å‡æ•°ï¼Œä¸€å®šä¸ºæ­£æ•°ï¼›åªéœ€è¦åœ¨`A`å‰é¢åŠ ä¸€ä¸ª`0`bit ä½œä¸ºç¬¦å·ä½å³å¯
  `assign A_comp = {1'b0, A};`
- `B` ä½œä¸ºåŠ æ•°/å‡æ•°ï¼Œæ ¹æ®æ§åˆ¶ä¿¡å· `X` æ¥ç¡®å®šå…¶æ­£è´Ÿï¼Œå¦‚æœæ˜¯åŠ æ³•(`X==0`)ï¼ŒåŠ ä¸€ä¸ª`0`ä½œä¸ºç¬¦å·ä½å³å¯ï¼›å¦‚æœæ˜¯å‡æ³•(`X==1`)ï¼Œé‚£ä¹ˆè¿ç®—å¯ä»¥è§†ä½œ`A+(-B)`ï¼Œ`-B`ä½œä¸ºè´Ÿæ•°ï¼Œæ±‚è¡¥ç éœ€è¦å…ˆæŒ‰ä½å–å(ç¬¦å·ä½ä¸éœ€è¦å–å)å†åŠ  1
  `assign B_comp = (X == 0) ? {1'b0, B} : {1'b1, ~B} + 1`

æ¥ä¸‹æ¥åˆ¤æ–­è¿ç®—ç»“æœæ˜¯å¦æº¢å‡º

- å¦‚æœæ˜¯å‡æ³•ï¼Œè¿ç®—ç»“æœä¸€å®šä¸ä¼šæº¢å‡ºï¼›(è¿ç®—ç»“æœä¸€å®šä¼šåœ¨ `0åˆ°-7`è¿™ä¸ªåŒºé—´é‡Œ)
- å¦‚æœæ˜¯åŠ æ³•ï¼Œè¿ç®—ç»“æœå¯èƒ½æº¢å‡ºï¼›ä¾‹å¦‚`A=011,B=110`å¾—åˆ°`Y=1101`ï¼Œä¸¤ä¸ªæ­£æ•°ç›¸åŠ å¾—åˆ°è´Ÿæ•°ï¼Œæ˜¾ç„¶å‘ç”Ÿäº†æº¢å‡ºï¼›
  `assign Overflow = (X == 0) ? Y[3] : 0;`

```verilog
module AdderSubtractor(
    input [2:0] A,    // 3-bit operand A
    input [2:0] B,    // 3-bit operand B
    input X,          // Control signal: 0 for addition, 1 for subtraction
    output [3:0] Y,   // 4-bit result to include overflow
    output Overflow   // Overflow indicator
);
    // 4-bit complement of A and B
    wire [3:0] A_comp;
    wire [3:0] B_comp;
    assign A_comp = {1'b0, A};
    assign B_comp = (X == 0) ? {1'b0, B} : {1'b1, ~B} + 1ï¼›
    assign Y = A_comp + B_comp;
    assign Overflow = (X == 0) ? Y[3] : 0;
endmodule
```

```shell
NET A<O> LOC=V5;
NET A<1> LOC=U4;
NET A<2> LOC=V3;
NET B<0> LOC=P4;
NET B<1> LOC=R4;
NET B<2> LOC=P6;
NET X LOC=P5;
NET Y<O> LOC=W3;
NET Y<1> LOC=Y4;
NET Y<2> LOC=Y1;
NET Y<3> LOC=AB4;
NET Overflow LOC=AA4;
```

### éªŒè¯å›¾ç‰‡

![alt text](https://vluv-space.s3.bitiful.net/UESTC/Embedded/lab2/lab2-8.webp)
